{"version":3,"sources":["interfaces/ariticle.js","local/articleUtil.js","interfaces/tags.js","local/tagUtils.js","components/CodemirrorEditor/index.jsx","components/EditorC/index.jsx"],"names":["markCode","code","marked","newArticle","_x","_newArticle","apply","this","arguments","_callee","articleObj","D_project_blog_frontend_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default","a","wrap","_context","prev","next","abrupt","getCSRF","then","CSRFTOKEN","form","FormData","append","title","author","content","tagId","Axios","post","stop","listArticles","_x2","_x3","_listArticles","_callee2","offset","limit","_context2","get","getTimeline","_getTimeline","_callee3","_context3","setOptions","renderer","Renderer","gfm","tables","breaks","pedantic","sanitize","smartLists","smartypants","highlight","hljs","highlightAuto","value","articleTool","id","targetId","articles","window","sessionStorage","getItem","JSON","parse","forEach","item","index","articleArr","setItem","stringify","splice","article","targetIndex","unshift","newTag","_newTag","tagObj","field","createdBy","listTags","_listTags","delTag","_delTag","tagTool","tags","tagArr","tag","normalizeLineEndings","str","replace","CodemirrorHandler","ReactCodeMirror","props","_this","Object","classCallCheck","_super","call","state","isFocused","componentWillReceiveProps","debounce","path","console","error","codeMirror","codemirror","fromTextArea","textareaNode","options","on","codemirrorValueChanged","bind","cursorActivity","focusChanged","scrollChanged","setValue","defaultValue","toTextArea","nextProps","undefined","getValue","preserveScrollPosition","prevScrollPosition","getScrollInfo","scrollTo","left","top","optionName","hasOwnProperty","setOptionIfChanged","newValue","oldValue","getOption","isEqual","setOption","focus","focused","setState","onFocusChange","cm","onCursorActivity","onScroll","doc","change","onChange","origin","_this2","react_default","createElement","className","ref","name","autoComplete","autoFocus","Component","defaultProps","configure","tabReplace","classPrefix","languages","EditorC","_UNMOUNTED","newItem","_author","tagSelected","_title","rawContent","res","data","status","message","success","Article","create","result","history","push","handleSearch","handleChange","aceBoxH","previewContent","currentTabIndex","hasContentChanged","scale","CodemirrorOptions","lineNumbers","theme","tabSize","lineWrapping","readOnly","mode","autoCloseTags","extraKeys","setExtraKeys","Option","Select","popContent","input","placeholder","es_select","showSearch","style","width","defaultActiveFirstOption","showArrow","filterOption","onSearch","notFoundContent","map","key","es_button","type","onClick","spellCheck","popover","trigger","placement","node","aceBox","height","editorBoxH","onMouseOver","setCurrentIndex","editContainer","CodemirrorEditor_ReactCodeMirror","containerScroll","updateCode","previewContainer","dangerouslySetInnerHTML","__html","previewWrap","_wizard","enableMenu","_this3","disableMenu","document","documentElement","clientHeight","querySelector","offsetHeight","Tag","getList","Error","catch","err","e","setScrollValue","scrollTop","containerH","newCode","that","assign","F11","Esc","resultObj","offsetLine","setCursor","appendTxtFn","appendValue","length","lastLine","getLine","React"],"mappings":"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","file":"static/js/8.7e8dd714.chunk.js","sourcesContent":["import Axios from \"axios\";\nimport marked from \"marked\";\nimport hljs from \"highlight.js\";\nimport {getCSRF} from \"./user\";\n\n\n// marked相关配置\nmarked.setOptions({\n    renderer: new marked.Renderer(),\n    gfm: true,\n    tables: true,\n    breaks: true,\n    pedantic: false,\n    sanitize: true,\n    smartLists: true,\n    smartypants: false,\n    highlight: function (code) {\n        return hljs.highlightAuto(code).value;\n    },\n});\n\n// mark编译\nexport function markCode(code) {\n    return marked(code)\n}\n\n// 保存文章\nexport async function newArticle(articleObj) {\n    return getCSRF().then(CSRFTOKEN => {\n        const form = new FormData();\n        form.append(\"title\", articleObj.title)\n        form.append(\"author\", articleObj.author ? articleObj.author : \"Wizard J\")\n        form.append(\"content\", articleObj.content)\n        form.append(\"tagId\", articleObj.tagId)\n        form.append(\"csrfmiddlewaretoken\", CSRFTOKEN)\n        return Axios.post(\"/api/new/article\", form)\n    })\n}\n\n// 获取文章列表\nexport async function listArticles(offset, limit) {\n    return Axios.get(\"/api/list/articles?limit=\" + limit + \"&offset=\" + offset)\n}\n\n// 获取归档信息\nexport async function getTimeline() {\n    return Axios.get(\"/api/get/timeline\")\n}","const articleTool = {}\n\n\n// 通过id从列表中获取文章\narticleTool.get = id => {\n    let targetId = -1;\n    const articles = window.sessionStorage.getItem(\"articles\") ? JSON.parse(window.sessionStorage.getItem(\"articles\")) : [];\n    articles.forEach((item, index) => {\n        if (item.id === id) targetId = index;\n    });\n    if (targetId !== -1) return articles[targetId];\n    else return null;\n}\n\n// 获取文章列表\narticleTool.getList = () => {\n    return window.sessionStorage.getItem(\"articles\") ? JSON.parse(window.sessionStorage.getItem(\"articles\")) : null;\n}\n\n// 将文章列表保存起来\narticleTool.save = (articleArr) => {\n    window.sessionStorage.setItem(\"articles\", JSON.stringify(articleArr));\n}\n\n// 删除文章\narticleTool.delete = (id) => {\n    const articles = window.sessionStorage.getItem(\"articles\") ? JSON.parse(window.sessionStorage.getItem(\"articles\")) : [];\n    articles.forEach((item, index) => {\n        if (item.id === id) articles.splice(index, 1);\n    });\n    window.sessionStorage.setItem(\"articles\", JSON.stringify(articles));\n}\n\n// 新建文章\narticleTool.create = (article) => {\n    const articles = window.sessionStorage.getItem(\"articles\") ? JSON.parse(window.sessionStorage.getItem(\"articles\")) : [];\n    let targetIndex = -1;\n    articles.forEach((item, index) => { // 去重\n        if (item.id === article.id) {\n            articles.splice(index, 1, article);\n            targetIndex = index;\n        }\n    });\n    if (targetIndex === -1) articles.unshift(article);\n    window.sessionStorage.setItem(\"articles\", JSON.stringify(articles));\n}\n\n\nexport default articleTool;","import Axios from \"axios\";\nimport {getCSRF} from \"./user\";\n\ngetCSRF();\n\n// 新建标签\nexport async function newTag(tagObj) {\n    return getCSRF().then(CSRFTOKEN => {\n        const form = new FormData();\n        for (let field in tagObj) {\n            form.append(field, tagObj[field])\n        }\n        if (!tagObj.createdBy) form.append(\"createdBy\", \"佚名\")\n        form.append(\"csrfmiddlewaretoken\", CSRFTOKEN)\n        return Axios.post(\"/api/new/tag\", form)\n    })\n}\n\n// 获取标签列表\nexport async function listTags() {\n    return Axios.get(\"/api/list/tags\")\n}\n\n// 删除标签\nexport async function delTag(id) {\n    return Axios.get(\"/api/del/tag?id=\" + id)\n}","const tagTool = {}\n\n// 通过id从列表中获取标签\ntagTool.get = id => {\n    let targetId = -1;\n    const tags = window.sessionStorage.getItem(\"tags\") ? JSON.parse(window.sessionStorage.getItem(\"tags\")) : [];\n    tags.forEach((item, index) => {\n        if (item.id === id) targetId = index;\n    });\n    if (targetId !== -1) return tags[targetId];\n    else return null;\n}\n\n// 获取标签列表\ntagTool.getList = () => {\n    return window.sessionStorage.getItem(\"tags\") ? JSON.parse(window.sessionStorage.getItem(\"tags\")) : null;\n}\n\n// 将标签列表保存起来\ntagTool.save = (tagArr) => {\n    window.sessionStorage.setItem(\"tags\", JSON.stringify(tagArr));\n}\n\n// 删除标签\ntagTool.delete = (id) => {\n    const tags = window.sessionStorage.getItem(\"tags\") ? JSON.parse(window.sessionStorage.getItem(\"tags\")) : [];\n    tags.forEach((item, index) => {\n        if (item.id === id) tags.splice(index, 1);\n    });\n    window.sessionStorage.setItem(\"tags\", JSON.stringify(tags));\n}\n\n// 新建标签\ntagTool.create = (tag) => {\n    const tags = window.sessionStorage.getItem(\"tags\") ? JSON.parse(window.sessionStorage.getItem(\"tags\")) : [];\n    let targetIndex = -1;\n    tags.forEach((item, index) => { // 去重\n        if (item.id === tag.id) {\n            tags.splice(index, 1, tag);\n        }\n    });\n    if (targetIndex === -1) tags.unshift(tag);\n    window.sessionStorage.setItem(\"tags\", JSON.stringify(tags));\n}\n\n\nexport default tagTool;","import React, {Component} from 'react'\nimport codemirror from 'codemirror'\nimport PropTypes from 'prop-types'\nimport isEqual from 'lodash.isequal'\nimport debounce from 'lodash.debounce'\n\nfunction normalizeLineEndings(str) {\n    if (!str) return str\n    return str.replace(/\\r\\n|\\r/g, '\\n')\n}\n\nlet CodemirrorHandler = null\n\nexport default class ReactCodeMirror extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            isFocused: false\n        }\n    }\n\n    componentWillMount() {\n        this.componentWillReceiveProps = debounce(this.componentWillReceiveProps, 0)\n        if (this.props.path) {\n            console.error('Warning: react-codemirror: the `path` prop has been changed to `name`')\n        }\n    }\n\n    componentDidMount() {\n        this.codeMirror = codemirror.fromTextArea(this.textareaNode, this.props.options)\n        CodemirrorHandler = this.codeMirror\n        CodemirrorHandler.on('change', this.codemirrorValueChanged.bind(this))\n        CodemirrorHandler.on('cursorActivity', this.cursorActivity.bind(this))\n        CodemirrorHandler.on('focus', this.focusChanged.bind(this, true))\n        CodemirrorHandler.on('blur', this.focusChanged.bind(this, false))\n        CodemirrorHandler.on('scroll', this.scrollChanged.bind(this))\n        CodemirrorHandler.setValue(this.props.defaultValue || this.props.value || '')\n    }\n\n    componentWillUnmount() {\n        if (this.codeMirror) {\n            this.codeMirror.toTextArea()\n        }\n    }\n\n    componentWillReceiveProps(nextProps) {\n        if (this.codeMirror && nextProps.value !== undefined && nextProps.value !== this.props.value && normalizeLineEndings(this.codeMirror.getValue()) !== normalizeLineEndings(nextProps.value)) {\n            if (this.props.preserveScrollPosition) {\n                var prevScrollPosition = this.codeMirror.getScrollInfo()\n                this.codeMirror.setValue(nextProps.value)\n                this.codeMirror.scrollTo(prevScrollPosition.left, prevScrollPosition.top)\n            } else {\n                this.codeMirror.setValue(nextProps.value)\n            }\n        }\n        if (typeof nextProps.options === 'object') {\n            for (let optionName in nextProps.options) {\n                if (nextProps.options.hasOwnProperty(optionName)) {\n                    this.setOptionIfChanged(optionName, nextProps.options[optionName])\n                }\n            }\n        }\n    }\n\n    setOptionIfChanged(optionName, newValue) {\n        const oldValue = this.codeMirror.getOption(optionName)\n        if (!isEqual(oldValue, newValue)) {\n            this.codeMirror.setOption(optionName, newValue)\n        }\n    }\n\n    getCodeMirror() {\n        return this.codeMirror\n    }\n\n    focus() {\n        if (this.codeMirror) {\n            this.codeMirror.focus()\n        }\n    }\n\n    focusChanged(focused) {\n        this.setState({\n            isFocused: focused,\n        })\n        this.props.onFocusChange && this.props.onFocusChange(focused)\n    }\n\n    cursorActivity(cm) {\n        this.props.onCursorActivity && this.props.onCursorActivity(cm)\n    }\n\n    scrollChanged(cm) {\n        this.props.onScroll && this.props.onScroll(cm.getScrollInfo())\n    }\n\n    codemirrorValueChanged(doc, change) {\n        if (this.props.onChange && change.origin !== 'setValue') {\n            this.props.onChange(doc.getValue(), change)\n        }\n    }\n\n    render() {\n        return (\n            <div className={this.props.className ? 'ReactCodeMirror ' + this.props.className : 'ReactCodeMirror'}>\n\t\t\t\t<textarea\n                    ref={ref => this.textareaNode = ref}\n                    name={this.props.name || this.props.path}\n                    defaultValue={this.props.value}\n                    autoComplete=\"off\"\n                    autoFocus={this.props.autoFocus}\n                />\n            </div>\n        )\n    }\n}\n\nexport {\n    CodemirrorHandler\n}\n\nReactCodeMirror.propTypes = {\n    autoFocus: PropTypes.bool,\n    className: PropTypes.any,\n    codeMirrorInstance: PropTypes.func,\n    defaultValue: PropTypes.string,\n    name: PropTypes.string,\n    onChange: PropTypes.func,\n    onCursorActivity: PropTypes.func,\n    onFocusChange: PropTypes.func,\n    onScroll: PropTypes.func,\n    options: PropTypes.object,\n    path: PropTypes.string,\n    value: PropTypes.string,\n    preserveScrollPosition: PropTypes.bool\n}\n\nReactCodeMirror.defaultProps = {\n    preserveScrollPosition: false\n}\n","import React from 'react'\nimport marked from 'marked'\nimport {Popover, Button, Select, message, Input} from \"antd\"\nimport highlight from 'highlight.js'\nimport {newArticle} from '../../interfaces/ariticle'\nimport {listTags} from \"../../interfaces/tags\"\nimport Tag from \"../../local/tagUtils\"\nimport Article from \"../../local/articleUtil\"\n\n\nimport CodemirrorEditor, {CodemirrorHandler} from '../CodemirrorEditor'\n\nimport 'codemirror/lib/codemirror.css'\nimport 'codemirror/theme/solarized.css'\n// 搜索 Ctrl-F (PC), Cmd-F (Mac)\n// 搜索的上一个结果 Shift-Ctrl-G (PC), Shift-Cmd-G (Mac)\n// 搜索的下一个结果 Ctrl-G (PC), Cmd-G (Mac)\n// 替换(replace)   Shift-Ctrl-F (PC), Cmd-Alt-F (Mac)\n// 替换全部(replaceAll)   Shift-Ctrl-R (PC), Shift-Cmd-Alt-F (Mac)\nimport 'codemirror/addon/search/search'\n// 光标跳到第几行 Alt-G，例如输入 9:26，则光标定位到第9行第26列\nimport 'codemirror/addon/search/jump-to-line'\n// 搜索或者跳转行数出现的弹出框样式\nimport 'codemirror/addon/dialog/dialog.css'\n// 当输入 '>' 或 '/' 字符的时候, 自动关闭标签\nimport 'codemirror/addon/edit/closetag'\n// 当光标定位于编辑器内，并且按 F11的时候编辑框全屏\nimport 'codemirror/addon/display/fullscreen'\n// 全屏样式\nimport 'codemirror/addon/display/fullscreen.css'\n\nimport 'codemirror/mode/javascript/javascript'\nimport 'codemirror/mode/jsx/jsx'\nimport 'codemirror/mode/css/css'\nimport 'codemirror/mode/sass/sass'\nimport 'codemirror/mode/xml/xml'\nimport 'codemirror/mode/markdown/markdown'\n\n// import '../../statics/style/common.css')\nimport \"../../statics/style/common.scss\"\nimport '../../statics/style/js-highlight.css'\nimport './style.scss'\n\nhighlight.configure({\n    tabReplace: '  ',\n    classPrefix: 'hljs-',\n    languages: ['CSS', 'HTML, XML', 'JavaScript', 'PHP', 'Python', 'Stylus', 'TypeScript', 'Markdown']\n})\nmarked.setOptions({\n    highlight(code) {\n        return highlight.highlightAuto(code).value\n    }\n})\n\nexport default class EditorC extends React.Component {\n\n    _UNMOUNTED = false;\n\n    constructor(props) {\n        super(props)\n        this.state = {\n            aceBoxH: null,\n            rawContent: '',\n            previewContent: '',\n            tags: [],\n            tagSelected: \"\",\n            currentTabIndex: 1,\n            hasContentChanged: false,\n            scale: 1\n        }\n        this.CodemirrorOptions = {\n            lineNumbers: false,\n            theme: 'solarized',\n            tabSize: 2,\n            lineWrapping: true,\n            readOnly: false,\n            mode: 'markdown',\n            // 是否自动闭合标签，基于 codemirror/addon/edit/closetag\n            autoCloseTags: true,\n            // 自定义快捷键\n            extraKeys: this.setExtraKeys()\n        }\n    }\n\n    render() {\n        let state = this.state;\n        const {Option} = Select;\n\n        const popContent = (\n            <div className=\"pop-over\">\n                <Input placeholder=\"署名\" ref={_author => this._author = _author}/>\n                <Select\n                    showSearch\n                    style={{width: \"100%\"}}\n                    placeholder={\"标签\"}\n                    defaultActiveFirstOption={false}\n                    showArrow={false}\n                    filterOption={false}\n                    onSearch={this.handleSearch}\n                    onChange={this.handleChange}\n                    notFoundContent={\"输入内容以新建\"}\n                >\n                    {this.state.tags.map((item, index) => <Option key={item.id}>{item.name}</Option>)}\n                </Select>\n                <Button type=\"primary\" onClick={this.newArticle}>确认</Button>\n            </div>\n        );\n        return [\n            <header className=\"edit-header\" key='header'>\n                <input type=\"text\" className=\"title-input\" placeholder=\"不要吹灭你的灵感和你的想象力; 不要成为你的模型的奴隶。 ——文森特・梵高\"\n                       spellCheck=\"false\" ref={_title => this._title = _title}/>\n                <Popover className=\"save-button\" content={popContent} title=\"biu biu biu\" trigger=\"click\"\n                         placement=\"bottomRight\">\n                    <Button>保存</Button>\n                </Popover>\n            </header>,\n            <div className=\"editor-main-c\" ref={node => this.aceBox = node} style={{height: state.editorBoxH + 'px'}}\n                 key='main'>\n                <div className=\"common-container editor-container\" onMouseOver={this.setCurrentIndex.bind(this, 1)}\n                     ref={node => this.editContainer = node}>\n                    {\n                        state.editorBoxH &&\n                        <CodemirrorEditor\n                            ref=\"editor\"\n                            onScroll={this.containerScroll.bind(this, 1)}\n                            onChange={this.updateCode.bind(this)}\n                            options={this.CodemirrorOptions}\n                            autoFocus={true}/>\n                    }\n                </div>\n                <div className=\"common-container preview-container\" ref={node => this.previewContainer = node}\n                     onMouseOver={this.setCurrentIndex.bind(this, 2)} onScroll={this.containerScroll.bind(this, 2)}>\n                    <div className=\"markdown-body preview-wrapper\"\n                         dangerouslySetInnerHTML={{__html: state.previewContent}}\n                         ref={node => this.previewWrap = node}></div>\n                </div>\n            </div>\n        ]\n    }\n\n    componentWillUnmount() {\n        this._UNMOUNTED = true;\n        window._wizard.enableMenu();\n    }\n\n    componentDidMount() {\n        window._wizard.disableMenu();\n        this.setState({\n            editorBoxH: document.documentElement.clientHeight - document.querySelector('.edit-header').offsetHeight\n        })\n        // 获取标签列表\n        if (Tag.getList()) { // 本地获取\n            this.setState({\n                tags: Tag.getList()\n            })\n            return;\n        } else { // 服务器获取\n            listTags()\n                .then(res => {\n                    if (this._UNMOUNTED) return;\n                    if (res.data.status === \"OK\") {\n                        this.setState({\n                            tags: res.data.result\n                        })\n                    } else {\n                        throw new Error(res.data.message)\n                    }\n                }).catch(err => {\n                    message.error(err.message)\n            })\n        }\n    }\n\n    setCurrentIndex(index) {\n        this.setState({\n            currentTabIndex: index\n        })\n    }\n\n    containerScroll(index, e) {\n        let state = this.state\n        state.hasContentChanged && this.setScrollValue()\n        if (state.currentTabIndex === 1 && index === 1) {\n            this.previewContainer.scrollTop = e.top * state.scale\n        } else if (state.currentTabIndex === 2 && index === 2) {\n            CodemirrorHandler.scrollTo(null, this.previewContainer.scrollTop / state.scale)\n        }\n    }\n\n    setScrollValue() {\n        // 设置值，方便 scrollBy 操作\n        // 两个容器元素的高度是相同的\n        let containerH = this.previewContainer.offsetHeight\n        this.setState({\n            scale: (this.previewWrap.offsetHeight - containerH) / (CodemirrorHandler.getScrollInfo().height - containerH),\n            hasContentChanged: false\n        })\n    }\n\n    updateCode(newCode) {\n        this.setState({\n            rawContent: newCode,\n            previewContent: marked(newCode)\n        })\n        !this.state.hasContentChanged && (this.setState({hasContentChanged: true}))\n    }\n\n    setExtraKeys() {\n        // 自定义快捷键\n        const that = this\n        let appendTxtFn = () => {\n            let resultObj = {}\n            let key2Command = [\n                {name: 'Ctrl-H', value: '## ', offset: 0},\n                {name: 'Ctrl-B', value: '**', offset: 1},\n                {name: 'Ctrl-K', value: '[]()', offset: 3},\n                {name: 'Alt-K', value: '``', offset: 1},\n                {name: 'Alt-C', value: '```js\\n\\n```', offset: 0, offsetLine: 1},\n                {name: 'Alt-I', value: '![alt]()', offset: 1},\n                {name: 'Alt-L', value: '* ', offset: 0}\n            ]\n            key2Command.forEach((item, index) => {\n                resultObj[item.name] = (cm) => {\n                    that.setCursor(cm, item.value, item.offset, item.offsetLine)\n                }\n            })\n            return resultObj\n        }\n        let otherKeys = {\n            'F11'(cm) {\n                // 全屏\n                cm.setOption('fullScreen', !cm.getOption('fullScreen'))\n            },\n            'Esc'(cm) {\n                // 退出全屏\n                if (cm.getOption('fullScreen')) cm.setOption('fullScreen', false)\n            }\n        }\n        return Object.assign(otherKeys, appendTxtFn())\n    }\n\n    setCursor(cm, appendValue, offset = 0, offsetLine = 0) {\n        let newValue = cm.getValue() + appendValue\n        cm.setValue(newValue)\n        let lastLine = cm.lastLine() - offsetLine\n        cm.setCursor(lastLine, cm.getLine(lastLine).length - offset)\n        this.updateCode(newValue)\n    }\n\n\n    // 保存文章动作\n    newArticle = () => {\n        const newItem = {\n            author: this._author.value,\n            tagId: this.state.tagSelected,\n            title: this._title.value,\n            content: this.state.rawContent\n        }\n        newArticle(newItem)\n            .then(res => {\n                // console.log(res)\n                if (res.data.status === \"OK\") {\n                    message.success(\"发表成功\")\n                    Article.create(res.data.result);\n                    this.props.history.push(\"/\")\n                }\n            })\n\n    }\n\n    // 标签搜索\n    handleSearch = value => {\n        // console.log(\">>>\",value)\n\n        // if (value) {\n        //   fetch(value, data => this.setState({ data }));\n        // } else {\n        //   this.setState({ data: [] });\n        // }\n    };\n\n    // 标签变化\n    handleChange = value => {\n        this.setState({\n            tagSelected: value\n        })\n    };\n\n\n}"],"sourceRoot":""}