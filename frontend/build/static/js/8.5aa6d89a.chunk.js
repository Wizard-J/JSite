(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{226:function(e,t,n){"use strict";n.d(t,"c",function(){return d}),n.d(t,"d",function(){return f}),n.d(t,"b",function(){return v}),n.d(t,"a",function(){return w});var r=n(19),a=n.n(r),o=n(42),i=n(61),s=n.n(i),c=n(231),u=n.n(c),l=n(232),p=n.n(l),h=n(85);function d(e){return u()(e)}function f(e){return g.apply(this,arguments)}function g(){return(g=Object(o.a)(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(h.a)().then(function(e){var n=new FormData;return n.append("title",t.title),n.append("author",t.author?t.author:"Wizard J"),n.append("content",t.content),n.append("tagId",t.tagId),n.append("csrfmiddlewaretoken",e),s.a.post("/api/new/article",n)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function v(e,t){return m.apply(this,arguments)}function m(){return(m=Object(o.a)(a.a.mark(function e(t,n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",s.a.get("/api/list/articles?limit="+n+"&offset="+t));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function w(){return S.apply(this,arguments)}function S(){return(S=Object(o.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",s.a.get("/api/get/timeline"));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}u.a.setOptions({renderer:new u.a.Renderer,gfm:!0,tables:!0,breaks:!0,pedantic:!1,sanitize:!0,smartLists:!0,smartypants:!1,highlight:function(e){return p.a.highlightAuto(e).value}})},233:function(e,t,n){"use strict";var r={get:function(e){var t=-1,n=window.sessionStorage.getItem("articles")?JSON.parse(window.sessionStorage.getItem("articles")):[];return n.forEach(function(n,r){n.id===e&&(t=r)}),-1!==t?n[t]:null},getList:function(){return window.sessionStorage.getItem("articles")?JSON.parse(window.sessionStorage.getItem("articles")):null},save:function(e){window.sessionStorage.setItem("articles",JSON.stringify(e))},delete:function(e){var t=window.sessionStorage.getItem("articles")?JSON.parse(window.sessionStorage.getItem("articles")):[];t.forEach(function(n,r){n.id===e&&t.splice(r,1)}),window.sessionStorage.setItem("articles",JSON.stringify(t))},create:function(e){var t=window.sessionStorage.getItem("articles")?JSON.parse(window.sessionStorage.getItem("articles")):[],n=-1;t.forEach(function(r,a){r.id===e.id&&(t.splice(a,1,e),n=a)}),-1===n&&t.unshift(e),window.sessionStorage.setItem("articles",JSON.stringify(t))}};t.a=r},236:function(e,t,n){"use strict";n.d(t,"c",function(){return u}),n.d(t,"b",function(){return p}),n.d(t,"a",function(){return d});var r=n(19),a=n.n(r),o=n(42),i=n(61),s=n.n(i),c=n(85);function u(e){return l.apply(this,arguments)}function l(){return(l=Object(o.a)(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(c.a)().then(function(e){var n=new FormData;for(var r in t)n.append(r,t[r]);return t.createdBy||n.append("createdBy","\u4f5a\u540d"),n.append("csrfmiddlewaretoken",e),s.a.post("/api/new/tag",n)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function p(){return h.apply(this,arguments)}function h(){return(h=Object(o.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",s.a.get("/api/list/tags"));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function d(e){return f.apply(this,arguments)}function f(){return(f=Object(o.a)(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",s.a.get("/api/del/tag?id="+t));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}Object(c.a)()},237:function(e,t,n){"use strict";var r={get:function(e){var t=-1,n=window.sessionStorage.getItem("tags")?JSON.parse(window.sessionStorage.getItem("tags")):[];return n.forEach(function(n,r){n.id===e&&(t=r)}),-1!==t?n[t]:null},getList:function(){return window.sessionStorage.getItem("tags")?JSON.parse(window.sessionStorage.getItem("tags")):null},save:function(e){window.sessionStorage.setItem("tags",JSON.stringify(e))},delete:function(e){var t=window.sessionStorage.getItem("tags")?JSON.parse(window.sessionStorage.getItem("tags")):[];t.forEach(function(n,r){n.id===e&&t.splice(r,1)}),window.sessionStorage.setItem("tags",JSON.stringify(t))},create:function(e){var t=window.sessionStorage.getItem("tags")?JSON.parse(window.sessionStorage.getItem("tags")):[];t.forEach(function(n,r){n.id===e.id&&t.splice(r,1,e)}),t.unshift(e),window.sessionStorage.setItem("tags",JSON.stringify(t))}};t.a=r},477:function(e,t,n){},478:function(e,t,n){},479:function(e,t,n){},500:function(e,t,n){"use strict";n.r(t);var r=n(29),a=n(30),o=n(18),i=n(31),s=n(0),c=n.n(s),u=n(231),l=n.n(u),p=n(218),h=n(494),d=n(493),f=n(254),g=n(491),v=n(232),m=n.n(v),w=n(226),S=n(236),y=n(237),C=n(233),b=n(223),O=n.n(b),k=n(461),I=n.n(k),N=n(462),M=n.n(N);function E(e){return e?e.replace(/\r\n|\r/g,"\n"):e}var x=null,j=function(e){Object(o.a)(n,e);var t=Object(i.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={isFocused:!1},a}return Object(a.a)(n,[{key:"componentWillMount",value:function(){this.componentWillReceiveProps=M()(this.componentWillReceiveProps,0),this.props.path&&console.error("Warning: react-codemirror: the `path` prop has been changed to `name`")}},{key:"componentDidMount",value:function(){this.codeMirror=O.a.fromTextArea(this.textareaNode,this.props.options),(x=this.codeMirror).on("change",this.codemirrorValueChanged.bind(this)),x.on("cursorActivity",this.cursorActivity.bind(this)),x.on("focus",this.focusChanged.bind(this,!0)),x.on("blur",this.focusChanged.bind(this,!1)),x.on("scroll",this.scrollChanged.bind(this)),x.setValue(this.props.defaultValue||this.props.value||"")}},{key:"componentWillUnmount",value:function(){this.codeMirror&&this.codeMirror.toTextArea()}},{key:"componentWillReceiveProps",value:function(e){if(this.codeMirror&&void 0!==e.value&&e.value!==this.props.value&&E(this.codeMirror.getValue())!==E(e.value))if(this.props.preserveScrollPosition){var t=this.codeMirror.getScrollInfo();this.codeMirror.setValue(e.value),this.codeMirror.scrollTo(t.left,t.top)}else this.codeMirror.setValue(e.value);if("object"===typeof e.options)for(var n in e.options)e.options.hasOwnProperty(n)&&this.setOptionIfChanged(n,e.options[n])}},{key:"setOptionIfChanged",value:function(e,t){var n=this.codeMirror.getOption(e);I()(n,t)||this.codeMirror.setOption(e,t)}},{key:"getCodeMirror",value:function(){return this.codeMirror}},{key:"focus",value:function(){this.codeMirror&&this.codeMirror.focus()}},{key:"focusChanged",value:function(e){this.setState({isFocused:e}),this.props.onFocusChange&&this.props.onFocusChange(e)}},{key:"cursorActivity",value:function(e){this.props.onCursorActivity&&this.props.onCursorActivity(e)}},{key:"scrollChanged",value:function(e){this.props.onScroll&&this.props.onScroll(e.getScrollInfo())}},{key:"codemirrorValueChanged",value:function(e,t){this.props.onChange&&"setValue"!==t.origin&&this.props.onChange(e.getValue(),t)}},{key:"render",value:function(){var e=this;return c.a.createElement("div",{className:this.props.className?"ReactCodeMirror "+this.props.className:"ReactCodeMirror"},c.a.createElement("textarea",{ref:function(t){return e.textareaNode=t},name:this.props.name||this.props.path,defaultValue:this.props.value,autoComplete:"off",autoFocus:this.props.autoFocus}))}}]),n}(s.Component);j.defaultProps={preserveScrollPosition:!1};n(463),n(464),n(465),n(467),n(468),n(469),n(471),n(472),n(247),n(473),n(248),n(474),n(240),n(475),n(477),n(478),n(479);n.d(t,"default",function(){return J}),m.a.configure({tabReplace:"  ",classPrefix:"hljs-",languages:["CSS","HTML, XML","JavaScript","PHP","Python","Stylus","TypeScript","Markdown"]}),l.a.setOptions({highlight:function(e){return m.a.highlightAuto(e).value}});var J=function(e){Object(o.a)(n,e);var t=Object(i.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e))._UNMOUNTED=!1,a.newArticle=function(){var e={author:a._author.value,tagId:a.state.tagSelected,title:a._title.value,content:a.state.rawContent};Object(w.d)(e).then(function(e){"OK"===e.data.status&&(p.a.success("\u53d1\u8868\u6210\u529f"),C.a.create(e.data.result),a.props.history.push("/"))})},a.handleSearch=function(e){},a.handleChange=function(e){a.setState({tagSelected:e})},a.state={aceBoxH:null,rawContent:"",previewContent:"",tags:[],tagSelected:"",currentTabIndex:1,hasContentChanged:!1,scale:1},a.CodemirrorOptions={lineNumbers:!1,theme:"solarized",tabSize:2,lineWrapping:!0,readOnly:!1,mode:"markdown",autoCloseTags:!0,extraKeys:a.setExtraKeys()},a}return Object(a.a)(n,[{key:"render",value:function(){var e=this,t=this.state,n=h.a.Option,r=c.a.createElement("div",{className:"pop-over"},c.a.createElement(d.a,{placeholder:"\u7f72\u540d",ref:function(t){return e._author=t}}),c.a.createElement(h.a,{showSearch:!0,style:{width:"100%"},placeholder:"\u6807\u7b7e",defaultActiveFirstOption:!1,showArrow:!1,filterOption:!1,onSearch:this.handleSearch,onChange:this.handleChange,notFoundContent:"\u8f93\u5165\u5185\u5bb9\u4ee5\u65b0\u5efa"},this.state.tags.map(function(e,t){return c.a.createElement(n,{key:e.id},e.name)})),c.a.createElement(f.a,{type:"primary",onClick:this.newArticle},"\u786e\u8ba4"));return[c.a.createElement("header",{className:"edit-header",key:"header"},c.a.createElement("input",{type:"text",className:"title-input",placeholder:"\u4e0d\u8981\u5439\u706d\u4f60\u7684\u7075\u611f\u548c\u4f60\u7684\u60f3\u8c61\u529b; \u4e0d\u8981\u6210\u4e3a\u4f60\u7684\u6a21\u578b\u7684\u5974\u96b6\u3002 \u2014\u2014\u6587\u68ee\u7279\u30fb\u68b5\u9ad8",spellCheck:"false",ref:function(t){return e._title=t}}),c.a.createElement(g.a,{className:"save-button",content:r,title:"biu biu biu",trigger:"click",placement:"bottomRight"},c.a.createElement(f.a,null,"\u4fdd\u5b58"))),c.a.createElement("div",{className:"editor-main-c",ref:function(t){return e.aceBox=t},style:{height:t.editorBoxH+"px"},key:"main"},c.a.createElement("div",{className:"common-container editor-container",onMouseOver:this.setCurrentIndex.bind(this,1),ref:function(t){return e.editContainer=t}},t.editorBoxH&&c.a.createElement(j,{ref:"editor",onScroll:this.containerScroll.bind(this,1),onChange:this.updateCode.bind(this),options:this.CodemirrorOptions,autoFocus:!0})),c.a.createElement("div",{className:"common-container preview-container",ref:function(t){return e.previewContainer=t},onMouseOver:this.setCurrentIndex.bind(this,2),onScroll:this.containerScroll.bind(this,2)},c.a.createElement("div",{className:"markdown-body preview-wrapper",dangerouslySetInnerHTML:{__html:t.previewContent},ref:function(t){return e.previewWrap=t}})))]}},{key:"componentWillUnmount",value:function(){this._UNMOUNTED=!0,window._wizard.enableMenu()}},{key:"componentDidMount",value:function(){var e=this;window._wizard.disableMenu(),this.setState({editorBoxH:document.documentElement.clientHeight-document.querySelector(".edit-header").offsetHeight}),y.a.getList()?this.setState({tags:y.a.getList()}):Object(S.b)().then(function(t){if(!e._UNMOUNTED){if("OK"!==t.data.status)throw new Error(t.data.message);e.setState({tags:t.data.result})}}).catch(function(e){p.a.error(e.message)})}},{key:"setCurrentIndex",value:function(e){this.setState({currentTabIndex:e})}},{key:"containerScroll",value:function(e,t){var n=this.state;n.hasContentChanged&&this.setScrollValue(),1===n.currentTabIndex&&1===e?this.previewContainer.scrollTop=t.top*n.scale:2===n.currentTabIndex&&2===e&&x.scrollTo(null,this.previewContainer.scrollTop/n.scale)}},{key:"setScrollValue",value:function(){var e=this.previewContainer.offsetHeight;this.setState({scale:(this.previewWrap.offsetHeight-e)/(x.getScrollInfo().height-e),hasContentChanged:!1})}},{key:"updateCode",value:function(e){this.setState({rawContent:e,previewContent:l()(e)}),!this.state.hasContentChanged&&this.setState({hasContentChanged:!0})}},{key:"setExtraKeys",value:function(){var e=this;return Object.assign({F11:function(e){e.setOption("fullScreen",!e.getOption("fullScreen"))},Esc:function(e){e.getOption("fullScreen")&&e.setOption("fullScreen",!1)}},function(){var t={};return[{name:"Ctrl-H",value:"## ",offset:0},{name:"Ctrl-B",value:"**",offset:1},{name:"Ctrl-K",value:"[]()",offset:3},{name:"Alt-K",value:"``",offset:1},{name:"Alt-C",value:"```js\n\n```",offset:0,offsetLine:1},{name:"Alt-I",value:"![alt]()",offset:1},{name:"Alt-L",value:"* ",offset:0}].forEach(function(n,r){t[n.name]=function(t){e.setCursor(t,n.value,n.offset,n.offsetLine)}}),t}())}},{key:"setCursor",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=e.getValue()+t;e.setValue(a);var o=e.lastLine()-r;e.setCursor(o,e.getLine(o).length-n),this.updateCode(a)}}]),n}(c.a.Component)}}]);
//# sourceMappingURL=8.5aa6d89a.chunk.js.map